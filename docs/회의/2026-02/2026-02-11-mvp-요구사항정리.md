좋습니다.
이번 건은 **시험용 화면 녹화 MVP**로 명확합니다.
과하지 않게, 그러나 실제로 돌아가게 설계하겠습니다.

---

# 📌 1. 기능 범위 정의서 (MVP 기준)

## 1) 핵심 기능

| 구분 | 기능명           | 설명                        | 필수 여부 |
| -- | ------------- | ------------------------- | ----- |
| F1 | 전체 화면 녹화      | getDisplayMedia로 화면 공유 요청 | 필수    |
| F2 | 비밀번호 시작 방식    | 감독관이 제공한 비밀번호 입력 후 시작     | 필수    |
| F3 | 녹화 상태 표시      | REC 표시 및 녹화 시간 표시         | 필수    |
| F4 | 시험 종료 시 녹화 저장 | 로컬 파일로 저장 (webm)          | 필수    |
| F5 | 전체 화면 여부 확인   | monitor 아닌 경우 시험 차단       | 필수    |
| F6 | 녹화 중지 감지      | 공유 끊기면 자동 종료              | 필수    |

---

## 2) 제외 기능 (1차 MVP에서 안 함)

| 기능         | 이유            |
| ---------- | ------------- |
| 웹캠 동시 녹화   | 일정 촉박         |
| 탭 전환 감지    | 기술적 복잡도 증가    |
| 실시간 서버 업로드 | 1차는 로컬 저장 테스트 |
| 관리자 대시보드   | 추후 개발         |

---

# 📌 2. 시험 흐름 정의

```
대기 화면
→ 비밀번호 입력
→ Start 버튼 활성화
→ 전체 화면 선택 요청
→ 녹화 시작
→ 시험 진행
→ 종료 버튼 클릭
→ 파일 자동 다운로드
```

---

# 📌 3. 화면 정의서 (Screen Specification)

---

## 🖥 1️⃣ [S01] 시험 대기 화면

### 목적

시험 시작 전 대기 및 비밀번호 입력

| 항목     | 내용                               |
| ------ | -------------------------------- |
| 화면 구성  | 로고 / 시험 제목 / 비밀번호 입력창 / Start 버튼 |
| 버튼 상태  | 비밀번호 입력 전 비활성화                   |
| 유효성 검사 | 비밀번호 일치 시 Start 활성화              |
| 에러 메시지 | "비밀번호가 일치하지 않습니다."               |

---

## 🖥 2️⃣ [S02] 화면 공유 요청 화면

### 목적

전체 화면 공유 강제 확인

| 항목    | 내용                            |
| ----- | ----------------------------- |
| 동작    | Start 클릭 시 getDisplayMedia 호출 |
| 확인 조건 | displaySurface === "monitor"  |
| 실패 시  | "전체 화면을 선택해주세요." 재요청          |
| 취소 시  | 시험 시작 불가                      |

---

## 🖥 3️⃣ [S03] 시험 진행 화면

### 목적

녹화 중 시험 진행

| 항목      | 내용                       |
| ------- | ------------------------ |
| 상단 고정 바 | 🔴 REC + 녹화 시간 표시        |
| 안내 문구   | "화면 공유를 중단하면 시험이 종료됩니다." |
| PDF 영역  | 시험지 표시 영역                |
| 종료 버튼   | 시험 종료                    |

### 예외 처리

| 상황        | 처리 방식         |
| --------- | ------------- |
| 화면 공유 중단  | 즉시 녹화 종료 + 알림 |
| 브라우저 새로고침 | 시험 종료 처리      |
| 네트워크 끊김   | 로컬 녹화는 유지     |

---

## 🖥 4️⃣ [S04] 시험 종료 화면

### 목적

녹화 파일 저장 완료 안내

| 항목      | 내용                    |
| ------- | --------------------- |
| 메시지     | "시험이 종료되었습니다."        |
| 파일명     | test_학생ID_날짜.webm     |
| 자동 다운로드 | MediaRecorder blob 저장 |
| 안내 문구   | "감독관에게 파일 제출하세요."     |

---

# 📌 4. 기술 구조 (로컬 테스트 기준)

| 영역       | 사용 기술                                                   |
| -------- | ------------------------------------------------------- |
| 프론트      | React                                                   |
| 화면 캡처    | getDisplayMedia                                         |
| 녹화       | MediaRecorder                                           |
| 파일 저장    | URL.createObjectURL + a.download                        |
| 전체 화면 체크 | stream.getVideoTracks()[0].getSettings().displaySurface |

---

# 📌 5. 로컬 테스트 체크리스트

| 체크 항목            | 확인 내용 |
| ---------------- | ----- |
| 전체 화면 선택 시 정상 녹화 | ✔     |
| 브라우저 탭 선택 시 차단   | ✔     |
| 4시간 이상 녹화 테스트    | ✔     |
| 파일 크기 확인         | ✔     |
| 공유 중단 시 종료 확인    | ✔     |

---

